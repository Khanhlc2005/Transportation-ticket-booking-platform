<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Trang Chủ - MyTicket</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body id="userPage">
    <header>
        <div class="logo"><i class="fa-solid fa-bus"></i> MyTicket</div>
        <div id="authSection"></div>
    </header>

    <div class="main-container">
        <h2 style="margin-bottom: 20px; color:#333">Danh sách chuyến xe</h2>
        <div class="grid-list" id="tripGrid"></div>
    </div>

    <div class="modal" id="bookingModal">
        <div class="modal-box" style="width: 500px;"> 
            <h3 style="border-bottom: 1px solid #eee; padding-bottom: 10px;">
                Đặt vé: <span id="routeTitle" style="color: #333; font-weight: 600;"></span>
            </h3>
            <div class="seat-container">
                <h4 style="margin: 10px 0; font-size: 14px;">Chọn ghế:</h4>
                <div class="seat-legend">
                    <div class="legend-item"><div class="box gray"></div> Đã bán</div>
                    <div class="legend-item"><div class="box blue"></div> Đang chọn</div>
                    <div class="legend-item"><div class="box white"></div> Còn trống</div>
                </div>
                <div class="seat-grid" id="seatGrid"></div>
            </div>
            <div class="form-group">
                <input type="text" id="cusName" placeholder="Họ và Tên hành khách">
                <input type="text" id="cusPhone" placeholder="Số điện thoại liên hệ">
            </div>
            <div class="payment-section">
                <h4>Phương thức thanh toán</h4>
                <div class="payment-options">
                    <label class="payment-radio"><input type="radio" name="payment" value="momo" checked> <img src="https://upload.wikimedia.org/wikipedia/vi/f/fe/MoMo_Logo.png" width="24"> Ví MoMo</label>
                    <label class="payment-radio"><input type="radio" name="payment" value="zalo"> <img src="https://cdn.haitrieu.com/wp-content/uploads/2022/10/Logo-ZaloPay-Square.png" width="24" style="border-radius: 5px;"> ZaloPay</label>
                    <label class="payment-radio"><input type="radio" name="payment" value="cash"> <i class="fa-solid fa-money-bill-wave" style="font-size: 20px; color: green;"></i> Tiền mặt khi lên xe</label>
                </div>
            </div>
            <div class="bill-summary">
                <span>Ghế đã chọn: <b id="selectedSeatsSpan">...</b></span><br>
                <span style="margin-top: 5px; display: block;">Tổng thanh toán: <span class="total-price" id="totalPriceSpan">0 đ</span></span>
            </div>
            <button class="btn-confirm" onclick="confirmBook()">Tiếp Tục</button>
            <button class="btn-cancel" onclick="closeModal()">Đóng lại</button>
        </div>
    </div>

    <div class="modal" id="confirmModal">
        <div class="modal-box" style="width: 450px;">
            <h3 style="color: #333; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px;">Xác nhận thông tin</h3>
            <p style="color: #666; font-size: 14px; margin-bottom: 20px;">Vui lòng kiểm tra kỹ thông tin vé trước khi thanh toán.</p>
            <div style="background: #f9fafb; padding: 15px; border-radius: 10px; border: 1px solid #e5e7eb; font-size: 14px;">
                <div class="receipt-row"><span>Hành khách:</span> <strong id="cName">...</strong></div>
                <div class="receipt-row"><span>SĐT:</span> <strong id="cPhone">...</strong></div>
                <div class="receipt-divider"></div>
                <div class="receipt-row"><span>Chuyến:</span> <strong id="cRoute">...</strong></div>
                <div class="receipt-row"><span>Giờ chạy:</span> <strong id="cTime">...</strong></div>
                <div class="receipt-row"><span>Ghế chọn:</span> <strong id="cSeats" style="color:var(--primary-color)">...</strong></div>
                <div class="receipt-row"><span>Thanh toán:</span> <strong id="cPayment">...</strong></div>
                <div class="receipt-divider"></div>
                <div class="receipt-row total" style="font-size: 16px;"><span>Tổng cộng:</span> <strong style="color: var(--danger-color);" id="cTotal">...</strong></div>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn-cancel" onclick="backToBooking()" style="margin-top:0; flex: 1;">Quay lại sửa</button>
                <button class="btn-confirm" onclick="processFinalPayment()" style="margin-top:0; flex: 1;">Xác nhận thanh toán</button>
            </div>
        </div>
    </div>

    <div class="modal" id="successModal">
        <div class="modal-box success-box">
            <div class="success-icon"><i class="fa-solid fa-circle-check"></i></div>
            <h3 style="color: var(--success-color); margin-bottom: 10px;">Thanh Toán Thành Công!</h3>
            <p style="text-align: center; color: #666; font-size: 14px; margin-bottom: 20px;">Cảm ơn bạn đã đặt vé. Dưới đây là hóa đơn điện tử của bạn:</p>
            <div class="ticket-receipt">
                <div class="receipt-row"><span class="r-label">Hành khách:</span><span class="r-value" id="rName">...</span></div>
                <div class="receipt-row"><span class="r-label">SĐT:</span><span class="r-value" id="rPhone">...</span></div>
                <div class="receipt-divider"></div>
                <div class="receipt-row"><span class="r-label">Nhà xe:</span><span class="r-value" id="rCompany">...</span></div>
                <div class="receipt-row"><span class="r-label">Chuyến:</span><span class="r-value" id="rRoute">...</span></div>
                <div class="receipt-row"><span class="r-label">Thời gian:</span><span class="r-value" id="rTime">...</span></div>
                <div class="receipt-row"><span class="r-label">Ghế đã chọn:</span><span class="r-value" id="rSeats" style="color: var(--primary-color);">...</span></div>
                <div class="receipt-divider"></div>
                <div class="receipt-row"><span class="r-label">Thanh toán qua:</span><span class="r-value" id="rPayment">...</span></div>
                <div class="receipt-row total"><span class="r-label">TỔNG TIỀN:</span><span class="r-value price" id="rTotal">...</span></div>
            </div>
            <button class="btn-confirm" onclick="closeSuccessModal()">Hoàn tất</button>
        </div>
    </div>

    <div class="modal" id="myTicketsModal">
        <div class="modal-box" style="width: 600px;">
            <h3 style="border-bottom: 1px solid #eee; padding-bottom: 10px; color: var(--primary-color);">Vé Của Tôi</h3>
            <div id="myTicketList" class="ticket-history-list"></div>
            <button class="btn-cancel" onclick="document.getElementById('myTicketsModal').style.display='none'">Đóng</button>
        </div>
    </div>

    <div class="modal" id="cancelTicketModal">
        <div class="modal-box" style="width: 400px; text-align: center;">
            <div style="font-size: 50px; color: var(--danger-color); margin-bottom: 10px;">
                <i class="fa-solid fa-ticket-simple"></i>
            </div>
            <h3 style="color: #333; margin-bottom: 10px;">Hủy Vé Xe?</h3>
            <p style="color: #666; font-size: 14px; margin-bottom: 25px;">
                Bạn có chắc chắn muốn hủy vé này không?<br>Hành động này không thể hoàn tác.
            </p>
            <div style="display: flex; gap: 10px;">
                <button class="btn-cancel" onclick="document.getElementById('cancelTicketModal').style.display='none'" style="margin-top:0; flex: 1;">Giữ lại</button>
                <button class="btn-confirm btn-danger" onclick="processCancelTicket()" style="margin-top:0; flex: 1;">Hủy vé ngay</button>
            </div>
        </div>
    </div>

    <div class="modal" id="deleteModal">
        <div class="modal-box" style="width: 400px; text-align: center;">
            <div style="font-size: 50px; color: var(--danger-color); margin-bottom: 10px;">
                <i class="fa-solid fa-triangle-exclamation"></i>
            </div>
            <h3 style="color: #333; margin-bottom: 10px;">Xóa Chuyến Xe?</h3>
            <p style="color: #666; font-size: 14px; margin-bottom: 25px;">
                Hành động này không thể hoàn tác.<br>Bạn có chắc chắn muốn xóa chuyến này không?
            </p>
            <div style="display: flex; gap: 10px;">
                <button class="btn-cancel" onclick="closeDeleteModal()" style="margin-top:0; flex: 1;">Hủy bỏ</button>
                <button class="btn-confirm btn-danger" onclick="confirmDeleteTrip()" style="margin-top:0; flex: 1;">Xóa ngay</button>
            </div>
        </div>
    </div>

    <div class="modal" id="alertModal">
        <div class="modal-box" style="width: 350px; text-align: center;">
            <div id="alertIcon" style="font-size: 50px; margin-bottom: 15px;"></div>
            <h3 id="alertTitle" style="margin-bottom: 10px;">Thông báo</h3>
            <p id="alertMessage" style="color: #666; font-size: 14px; margin-bottom: 20px;"></p>
            <button class="btn-confirm" onclick="document.getElementById('alertModal').style.display='none'">Đóng</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>